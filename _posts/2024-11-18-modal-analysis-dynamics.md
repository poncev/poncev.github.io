---
layout: post
title: "Modal Analysis: dynamics"
author: "Felipe Ponce-Vanegas"
categories: general
tags: [modal analysis]
---

In this follow-up to [our post on basic concepts]({% post_url 2024-11-06-modal-analysis-basics %}),
we will explore the dynamics generated by models of linear vibrations.

Linear models of vibrating structures have the form

$$
\begin{equation}
M\ddot{x} + C\dot{x} + Kx = F,
\label{eq:basic_vibrations}
\end{equation}
$$

where $x(t) \in \R^N$ is a vector function representing the displacement from equilibrium,
$F$ are external forces,
$M$ is the mass, $C$ is the damping, and $K$ is the stiffness.

The differential equation \eqref{eq:basic_vibrations} can be rewritten as the first order ODE

$$
\begin{align}
    \frac{d}{dt}
    \begin{bmatrix}
        x \\ \dot{x}
    \end{bmatrix}
    &=
    \Omega
    \begin{bmatrix}
        x \\ \dot{x}
    \end{bmatrix}
    +
    \begin{bmatrix}
        0 \\ M^{-1}F
    \end{bmatrix} \notag\\
    &:=
    \begin{bmatrix}
        0 & I \\
        -M^{-1}K & -M^{-1}C
    \end{bmatrix}
    \begin{bmatrix}
        x \\ \dot{x}
    \end{bmatrix}
    +
    \begin{bmatrix}
        0 \\ M^{-1}F
    \end{bmatrix};
    \label{eq:rewriting_main}
\end{align}
$$

recall that the symbol ($:=$) is used to introduce a definition, in this case for $\Omega$.
The general solution of this equation is

$$
\begin{equation*}
    \begin{bmatrix}
        x(t) \\ \dot{x}(t)
    \end{bmatrix}
    =
    U(t)
    \begin{bmatrix}
        x_0 \\ \dot{x}_0
    \end{bmatrix}
    +
    \int_0^t U(t - \tau)
    \begin{bmatrix}
        0 \\ M^{-1}F(\tau)
    \end{bmatrix}
    \,d\tau,
\end{equation*}
$$

where $x_0$ is the initial position, $\dot{x}_0$ is the initial velocity, and
$U$ is the solution operator of the homogeneous equation ($F = 0$).
If $(u, v)^t$ is a column vector, then $U(t)(u, v)^t$ is a solution of the homogeneous system
with initial conditions $x_0 = u$ and $\dot{x}_0 = v$.

As we saw in our [previous post]({% post_url 2024-11-06-modal-analysis-basics %}),
if $\Phi := (\phi_1, \ldots, \phi_N)$ is the basis of mass-normalized mode shapes, $Z := \diag(z_1, \ldots, z_N)$ the eigenvalues, and

$$
\begin{equation*}
    L :=
    \begin{bmatrix}
        \Phi & \bar{\Phi} \\
        \Phi Z & \bar{\Phi}\bar{Z}
    \end{bmatrix},
\end{equation*}
$$

then

$$
\begin{equation*}
    L^{-1}\Omega L =
    \begin{bmatrix}
        Z & \\
         & \bar{Z}
    \end{bmatrix}.
\end{equation*}
$$

Therefore, the solution operator is

$$
\begin{align*}
    U(t) &=
    L
    \begin{bmatrix}
        e^{Zt} & \\
         & e^{\bar{Z}t}
    \end{bmatrix}
    L^{-1} \\
    &=
    \begin{bmatrix}
        -\im\Big(\Phi \frac{e^{Zt}}{Z\im(Z)}\Phi^t\Big)K & \im\Big(\Phi \frac{e^{Zt}}{\im(Z)}\Phi^t\Big)M \\
        -\im\Big(\Phi \frac{e^{Zt}}{\im(Z)}\Phi^t\Big)K & \im\Big(\Phi \frac{Ze^{Zt}}{\im(Z)}\Phi^t\Big)M
    \end{bmatrix}.
\end{align*}
$$

When the damping is proportional, the mode shapes are real and
we can take them outside the $\im()$ operation.

During modal testing, the piece is initially at rest ($x_0 = \dot{x}_0 = 0$), and
the force has the form $F(t) = wf(t)$, for $w \in \R^N$ and $f$ a scalar function, so
the evolution of the system is

$$
\begin{equation}
    x(t)
    =
    \im\Big[\Phi \frac{1}{\im(Z)}\Big(\int_0^t e^{Z(t - \tau)}f(\tau)\,d\tau\Big) \Phi^t w\Big].
    \label{eq:evolution}
\end{equation}
$$

If we extend the force to the past as $f = 0$ so that $f$ is a function in $\R$, then
the components of the integral between parentheses equals the convolution $(1_{\R _+}e^{z_kt}) \star f$,
where $1 _{\R _+}$ is the indicator function

$$
\begin{equation*}
    1_{\R _+}(t) =
    \begin{cases}
        1 & \text{if } t > 0, \\
        0 & \text{otherwise.}
    \end{cases}
\end{equation*}
$$

Taking the Fourier transform of \eqref{eq:evolution}, and
assuming that $\re(Z) < 0$, we get

$$
\begin{gather*}
    \hat{x}(\omega) = (G(\omega) + \bar{G}(-\omega))w\hat{f}(\omega) \\
    G(\omega) := -\frac{1}{4\pi}
    \Phi \frac{1}{\im(Z)}\Big(\frac{1}{\omega + iZ/(2\pi)}\Big) \Phi^t,
\end{gather*}
$$

or component-wise

$$
\begin{equation*}
    G_{lm}(\omega) = -\frac{1}{4\pi}\sum_{k=1}^N
    \frac{\phi _{k,l}\phi _{k,m}}{\im(z_k)(\omega + iz_k/(2\pi))},
\end{equation*}
$$

where $\phi_k = (\phi_{k, 1}, \cdots, \phi_{k, N})$ are the mode shapes.

If the system is **initially at rest** (and not otherwise), then

$$
\begin{equation*}
    (-(4\pi^2)\omega^2 M + 2\pi i \omega C + K)\hat{x}(\omega) = w\hat{f}(\omega).
\end{equation*}
$$

Hence, we conclude that the transfer function is

$$
\begin{equation*}
    (-(4\pi^2)\omega^2 M + 2\pi i \omega C + K)^{-1} = G(\omega) + \bar{G}(-\omega).
\end{equation*}
$$

These relationships are important to interpret the results of modal tests.
